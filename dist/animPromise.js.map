{"version":3,"file":"animPromise.js","sourceRoot":"","sources":["../animPromise.ts"],"names":[],"mappings":"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","sourcesContent":["import * as PIXI from \"pixi.js\"\r\n\r\n\texport class Scheduler {\r\n\t\tprivate runningProcesses: Process[];\r\n\t\tprivate intervals: Array<{delay: Process, callback: () => void, context?: any}>;\r\n\r\n\t\tconstructor() {\r\n\t\t\tthis.runningProcesses = [];\r\n\t\t\tthis.intervals = [];\r\n\t\t}\r\n\r\n\t\tpublic run(process: Process, sprite: PIXI.Container): Promise<PIXI.Container> {\r\n\t\t\tprocess.setTarget(sprite);\r\n\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\tprocess.setEndCallback(resolve);\r\n\t\t\t\tprocess.run();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tpublic pause(): void {\r\n\t\t\tfor (let process of this.runningProcesses) {\r\n\t\t\t\tprocess.pause();\r\n\t\t\t}\r\n\t\t\tfor (let interval of this.intervals) {\r\n\t\t\t\tinterval.delay.pause();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic resume(): void {\r\n\t\t\tfor (let process of this.runningProcesses) {\r\n\t\t\t\tprocess.resume();\r\n\t\t\t}\r\n\t\t\tfor (let interval of this.intervals) {\r\n\t\t\t\tinterval.delay.resume();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic stop(): void {\r\n\t\t\tthis.pause();\r\n\t\t\tthis.runningProcesses = [];\r\n\t\t}\r\n\r\n\t\tpublic addRunningProcess(process: Process) {\r\n\t\t\tfor (let currProc of this.runningProcesses) {\r\n\t\t\t\tif (currProc.id === process.id) return; // don't add the same process twitce (happens in setInterval when paused/resumed few times)\r\n\t\t\t}\r\n\t\t\tthis.runningProcesses.push(process);\r\n\t\t}\r\n\r\n\t\tpublic removeRunningProcess(process: Process) {\r\n\t\t\tfor (let i = 0; i < this.runningProcesses.length; i++) {\r\n\t\t\t\tif (this.runningProcesses[i].id == process.id) {\r\n\t\t\t\t\tthis.runningProcesses.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic forceFinish(process: Process) {\r\n\t\t\tfor (let i = 0; i < this.runningProcesses.length; i++) {\r\n\t\t\t\tif (this.runningProcesses[i].id == process.id) {\r\n\t\t\t\t\tthis.runningProcesses[i].forceFinish();\r\n\t\t\t\t\tthis.runningProcesses.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic setTimeOut(duration: number, callback: () => void, context?: any): Delay {\r\n\t\t\tconst delay = new Delay();\r\n\t\t\tdelay.setTarget(new PIXI.Sprite());\r\n\t\t\tdelay.setEndCallback(callback, context);\r\n\t\t\tdelay.setDuration(duration);\r\n\t\t\tdelay.run();\r\n\t\t\treturn delay;\r\n\t\t}\r\n\r\n\t\tpublic clearTimeOut(delay: Delay) {\r\n\t\t\tdelay.stop();\r\n\t\t}\r\n\r\n\t\tpublic setInterval(duration: number, callback: () => void, context?: any): Process {\r\n\t\t\tconst delay: Process = new Delay().setDuration(duration);\r\n\t\t\tdelay.setDuration(duration);\r\n\r\n\t\t\tthis.intervals.push({\r\n\t\t\t\tdelay,\r\n\t\t\t\tcallback,\r\n\t\t\t\tcontext\r\n\t\t\t});\r\n\t\t\tdelay.setEndCallback(this.nextInterval, this.intervals[this.intervals.length - 1]);\r\n\t\t\tdelay.setTarget(new PIXI.Sprite());\r\n\t\t\tdelay.run();\r\n\t\t\treturn delay;\r\n\t\t}\r\n\r\n\t\tprivate nextInterval() {\r\n\t\t\t(<any>this).callback.call((<any>this).context);\r\n\t\t\tif (!(<any>this).delay.isStopped) (<any>this).delay.run();\r\n\t\t}\r\n\r\n\t\tpublic clearInterval(delay: Process): void {\r\n\t\t\tdelay.stop();\r\n\t\t\tfor (let i = 0; i < this.intervals.length; i++) {\r\n\t\t\t\tif (this.intervals[i].delay.id == delay.id) {\r\n\t\t\t\t\tthis.intervals.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport var scheduler: Scheduler = new Scheduler();\r\n\r\n\tlet animPaused: boolean = false;\r\n\t//let epsilon: number = 0.001;\r\n\r\n\r\n\r\n\texport var Types = {\r\n\t\tProcess: \"process\",\r\n\t\tDelay: \"delay\",\r\n\t\tSequence: \"sequence\",\r\n\t\tParallel: \"parallel\",\r\n\t\tFadeTo: \"fadeTo\",\r\n\t\tMoveTo: \"moveTo\",\r\n\t\tMoveBy: \"moveBy\",\r\n\t\tRotateTo: \"rotateTo\",\r\n\t\tRotateBy: \"rotateBy\",\r\n\t\tScaleTo: \"scaleTo\",\r\n\t\tScaleBy: \"scaleBy\"\r\n\t};\r\n\r\n\texport class Process {\r\n\t\tpublic id: number;\r\n\t\tprotected type: string = Types.Process;\r\n\t\tprotected duration: number = 1000;\r\n\t\tprotected currTime: number = 0;\r\n\t\tprotected target: PIXI.Container;\r\n\t\tprotected endCallback: (target: PIXI.Container) => void;\r\n\t\tprotected endCallbackContext: any;\r\n\t\tpublic isStopped: boolean;\r\n\r\n\t\tprivate prevTimestamp: number;\r\n\r\n\t\tprivate currRequestId: number;\r\n\r\n\t\tconstructor() {\r\n\t\t\tthis.id = Math.random() * 10000;\r\n\t\t\tthis.isStopped = false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {number} duration of animation in milliseconds\r\n\t\t * @returns {bc.Process}\r\n\t\t */\r\n\t\tpublic setDuration(duration: number): Process {\r\n\t\t\tthis.duration = duration;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tpublic setTarget(target: PIXI.Container): void {\r\n\t\t\tthis.target = target;\r\n\t\t}\r\n\r\n\t\tpublic setEndCallback(callback: (target: PIXI.Container) => void, callbackContext?: any) {\r\n\t\t\tthis.endCallback = callback;\r\n\t\t\tthis.endCallbackContext = callbackContext;\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tif (!this.target) {\r\n\t\t\t\tconsole.warn(\"Anim \" + this.type + \" target not specified\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isStopped = false;\r\n\t\t\tthis.currTime = 0;\r\n\t\t\tthis.prevTimestamp = performance.now();\r\n\t\t\tscheduler.addRunningProcess(this);\r\n\t\t\tif (!animPaused) this.currRequestId = requestAnimationFrame(this.requestAnimCallback);\r\n\t\t};\r\n\r\n\t\tprotected requestAnimCallback = () => {\r\n\t\t\tconst currTime = performance.now();\r\n\t\t\tlet delta = currTime - this.prevTimestamp;\r\n\t\t\tif (this.currTime + delta >= this.duration) {\r\n\t\t\t\tdelta = this.duration - this.currTime;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.currRequestId = requestAnimationFrame(this.requestAnimCallback);\r\n\t\t\t}\r\n\t\t\tthis.currTime += delta;\r\n\t\t\tthis.prevTimestamp = currTime;\r\n\t\t\tthis.update(delta);\r\n\t\t\tif (this.currTime == this.duration) {\r\n\t\t\t\tif (this.endCallback) this.endCallback.call(this.endCallbackContext, this.target);\r\n\t\t\t\tscheduler.removeRunningProcess(this);\r\n\t\t\t\tthis.isStopped = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpublic pause() {\r\n\t\t\tcancelAnimationFrame(this.currRequestId);\r\n\t\t}\r\n\r\n\t\tpublic resume() {\r\n\t\t\tthis.prevTimestamp = performance.now();\r\n\t\t\tthis.currRequestId = requestAnimationFrame(this.requestAnimCallback);\r\n\t\t}\r\n\r\n\t\tpublic stop() {\r\n\t\t\tthis.isStopped = true;\r\n\t\t\tcancelAnimationFrame(this.currRequestId);\r\n\t\t\tscheduler.removeRunningProcess(this);\r\n\t\t}\r\n\r\n\t\tpublic forceFinish() {\r\n\t\t\tcancelAnimationFrame(this.currRequestId);\r\n\t\t\tthis.update(this.duration - this.currTime);\r\n\t\t\tif (this.endCallback) this.endCallback.call(this.endCallbackContext, this.target);\r\n\t\t\tscheduler.removeRunningProcess(this);\r\n\t\t\tthis.isStopped = true;\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tdelta;\r\n\t\t}\r\n\t}\r\n\r\n\texport class Delay extends Process {\r\n\t\tconstructor() {\r\n\t\t\tsuper();\r\n\t\t\tthis.type = Types.Delay;\r\n\t\t}\r\n\t}\r\n\r\n\texport class Sequence extends Process {\r\n\t\tprivate subProcesses: Process[] = [];\r\n\t\tprivate currentRunningIndex: number;\r\n\r\n\t\tconstructor(processes: Process[]) {\r\n\t\t\tsuper();\r\n\t\t\tthis.type = Types.Sequence;\r\n\t\t\tthis.subProcesses = processes;\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tthis.currentRunningIndex = 0;\r\n\t\t\tthis.next();\r\n\t\t}\r\n\r\n\t\tprivate increaseCounter = () => {\r\n\t\t\tthis.currentRunningIndex++;\r\n\t\t\tthis.next();\r\n\t\t}\r\n\r\n\t\tprivate next(): void {\r\n\t\t\tconst currProcess = this.subProcesses[this.currentRunningIndex];\r\n\t\t\tif (currProcess) {\r\n\t\t\t\tcurrProcess.setTarget(this.target);\r\n\t\t\t\tcurrProcess.setEndCallback(this.increaseCounter);\r\n\t\t\t\tcurrProcess.run();\r\n\t\t\t}\r\n\t\t\telse if (this.endCallback) {\r\n\t\t\t\tthis.endCallback.call(this.endCallbackContext, this.target);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport class Parallel extends Process {\r\n\t\tprivate subProcesses: Process[] = [];\r\n\t\tprivate endedProcesses: number = 0;\r\n\r\n\t\tconstructor(processes: Process[]) {\r\n\t\t\tsuper();\r\n\t\t\tthis.type = Types.Parallel;\r\n\t\t\tthis.subProcesses = processes;\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tfor (let process of this.subProcesses) {\r\n\t\t\t\tprocess.setTarget(this.target);\r\n\t\t\t\tprocess.setEndCallback(this.checkEnd);\r\n\t\t\t\tprocess.run();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tprivate checkEnd = () => {\r\n\t\t\tthis.endedProcesses++;\r\n\t\t\tif (this.endedProcesses === this.subProcesses.length && this.endCallback) {\r\n\t\t\t\tthis.endCallback.call(this.endCallbackContext, this.target);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport class FadeTo extends Process {\r\n\t\tprivate to: number;\r\n\t\tprivate fadeDiffPerMilliSec: number;\r\n\r\n\t\tconstructor(to: number) {\r\n\t\t\tsuper();\r\n\t\t\tthis.type = Types.FadeTo;\r\n\t\t\tthis.to = to;\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.fadeDiffPerMilliSec = (this.to - this.target.alpha) / this.duration;\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.alpha += delta * this.fadeDiffPerMilliSec;\r\n\t\t}\r\n\t}\r\n\r\n\texport class MoveTo extends Process {\r\n\t\tprivate to: PIXI.Point;\r\n\t\tprivate dir: PIXI.Point;\r\n\r\n\t\tconstructor(to: PIXI.Point) {\r\n\t\t\tsuper();\r\n\t\t\tthis.to = new PIXI.Point(to.x, to.y);\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.dir = new PIXI.Point(\r\n\t\t\t\t(this.to.x - this.target.x) / this.duration,\r\n\t\t\t\t(this.to.y - this.target.y) / this.duration\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.x += this.dir.x * delta;\r\n\t\t\tthis.target.y += this.dir.y * delta;\r\n\t\t}\r\n\t}\r\n\r\n\texport class MoveBy extends Process {\r\n\t\tprivate dir: PIXI.Point;\r\n\t\tprivate by: PIXI.Point;\r\n\r\n\t\tconstructor(by: PIXI.Point) {\r\n\t\t\tsuper();\r\n\t\t\tthis.by = new PIXI.Point(by.x, by.y);\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.dir = new PIXI.Point(this.by.x / this.duration, this.by.y / this.duration);\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.x += this.dir.x * delta;\r\n\t\t\tthis.target.y += this.dir.y * delta;\r\n\t\t}\r\n\t}\r\n\r\n\texport class ScaleTo extends Process {\r\n\t\tprivate to: PIXI.Point;\r\n\t\tprivate amount: PIXI.Point;\r\n\r\n\t\tconstructor(x: number, y?: number) {\r\n\t\t\tsuper();\r\n\t\t\tthis.to = new PIXI.Point();\r\n\t\t\tthis.to.set(x, y ? y : x);\r\n\t\t\tthis.amount = new PIXI.Point();\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.amount.set(\r\n\t\t\t\t(this.to.x - this.target.scale.x) / this.duration,\r\n\t\t\t\t(this.to.y - this.target.scale.y) / this.duration,\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.scale.x += this.amount.x * delta;\r\n\t\t\tthis.target.scale.y += this.amount.y * delta;\r\n\t\t}\r\n\t}\r\n\r\n\texport class ScaleBy extends Process {\r\n\t\tprivate amount: PIXI.Point;\r\n\t\tprivate by: PIXI.Point;\r\n\r\n\t\tconstructor(by: PIXI.Point) {\r\n\t\t\tsuper();\r\n\t\t\tthis.by = new PIXI.Point(by.x, by.y);\r\n\t\t\tthis.amount = new PIXI.Point();\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.amount.set(this.by.x / this.duration, this.by.y / this.duration);\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.scale.x += this.amount.x * delta;\r\n\t\t\tthis.target.scale.y += this.amount.y * delta;\r\n\t\t}\r\n\t}\r\n\r\n\texport class RotateTo extends Process {\r\n\t\tprivate to: number;\r\n\t\tprivate amount: number;\r\n\r\n\t\tconstructor(angle: number) {\r\n\t\t\tsuper();\r\n\t\t\tthis.to = angle;\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.amount = (this.to - this.target.rotation) / this.duration;\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.rotation += this.amount * delta;\r\n\t\t}\r\n\t}\r\n\r\n\texport class RotateBy extends Process {\r\n\t\tprivate amount: number;\r\n\t\tprivate by: number;\r\n\r\n\t\tconstructor(angle: number) {\r\n\t\t\tsuper();\r\n\t\t\tthis.by = angle;\r\n\t\t}\r\n\r\n\t\tpublic run(): void {\r\n\t\t\tsuper.run();\r\n\t\t\tthis.amount = this.by / this.duration;\r\n\t\t}\r\n\r\n\t\tprotected update(delta: number) {\r\n\t\t\tthis.target.rotation += this.amount * delta;\r\n\t\t}\r\n\t}\r\n\r\n"]}